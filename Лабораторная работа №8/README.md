# Объектно-ориентированное программирование  

## Лабораторная работа №8  
---  
## Теоретическая справка   

### Обработка исключений в С++  

Обработка исключений в С++ использует три ключевых слова: try, catch и throw. Те инструкции программы, где ожидается возможность появления исключительных ситуаций, содержатся в бло­ке try. Если в блоке try возникает исключение, т. е. ошибка, то генерируется исключение. Исклю­чение перехватывается, используя catch, и обрабатывается.

### Try / Catch

Работа с try / catch очень похожа на работу с if / else. Но главное отличие, что try берет участок кода, который в него помещают, и пытается его исполнить, если код выполняется без ошибок, то программа идет дальше, а если что-то идет не так, то мы можем поймать ошибку и обработать.  

При выполнении первых лабораторных работ, у многих вылетала программа, мало кто понимал почему, но чаще всего проблема была в неправильном преобразовании string в int.  

Вот тут то нам и пригодится try / catch:  
```cpp
try {
    std::string line;
    std::getline(fin, line);

    auto f = split_line(line, ',');

    Films film;

    film.setRating(std::stoi(f[1]));

    result.push_back(film);

} catch(const std::exception &e) {
    std::cout << e.what() << std::endl;
}
```
Чем то похоже на if / else, не так ли?

В данном примере мы поместили кусок кода из `readAll()` функции в try / catch. Теперь он будет выполнятся, но если вдруг встретится ошибка, например, с stoi, о которой говорилось выше, то программа не сломается и продолжит свою работу, а мы получим сообщение о проблеме и сможем ее обработать или исправить.

Метод `what()` выдает нам что за ошибка произошла.

В `catch` мы можем передать много разных параметров.

#### Try

Try - позволяет определить блок кода, который будет проверяться на наличие ошибок во время его выполнения;

#### Catch  

Catch - блок кода, который выполняется при возникновении определенного исключения в блоке try.

#### Throw

Throw нужен для создания и отображения исключений и используется для перечисления ошибок, которые генерирует функция, но не может самостоятельно обрабатывать исключения;


```cpp
try {
    bool TheEnd = false;
  if (TheEnd) 
        std::cout << "Congratulations! You've killed The Ender Dragon!" << std::endl;
   else 
        throw (TheEnd);
}
catch (bool achievement) {
    std::cout << "To obtain this achievemnet you have to kill The Ender Dragon!" << std::endl;
    std::cout << "Achievement status: " << achievement << std::endl;
}
```

Разберем пример:  

В блоке `try` мы имеем переменную и условие, в случае, если условие не выполняется, то мы генерируем исключение с помощью `throw` и пробрасываем TheEnd.  

Далее в дело вступает блок `catch`, который ее ловит, там мы и обрабатываем наше исключение, в данном случае выводим сообщение.

### Множество catch

При работе с try / catch мы можем отплавливать несколько исключений.  

```cpp
try {
    //Code
}

catch(Exception e1){
    //Code
}
catch(Exception e2){
    //Code
}
catch(Exception e3){
    //Code
}

//...

catch(Exception eN){
    //code
}
```

### Обработка всех ошибок

В примерах выше мы указывали, какие ошибки мы хотим отлавливать.

Чтобы не конкретизировать ошибки, которые мы хотим поймать, можно отлавливать все проблемы: 

```cpp
try {
    //Code
}
catch(...) {
    //
}
```
Теперь все, что не пройдет в блоке `try`, перейдет в catch. Удобно, если мы не знаем, что за ошибка там возникает или не знаем их всех, то можно поймать и определить.

---
## **Задание**  

Сделать обработку исключений для чтения CSV файлов, при возникновении ошибки - в консоль передать номер строки, на которой возникла проблема.

---

## Вопросы
1. Что такое try
2. Что такое catch
3. Что такое throw
4. Зачем применяют try / catch

